(function(){var s=true&&document.implementation&&document.implementation.createDocument;var b=(typeof DOMParser!=="undefined");var a=(typeof document.importNode!=="undefined");var v=(typeof document.adoptNode!=="undefined");var d=(typeof XSLTProcessor!=="undefined");var u=(typeof XPathEvaluator!=="undefined");var m=true&&window.ActiveXObject;var n;var B;var z;if(m){n=g(["Msxml2.DOMDocument.3.0"]);B=g(["MSXML2.FreeThreadedDOMDocument.6.0","MSXML2.FreeThreadedDOMDocument.3.0"]);z=g(["Msxml2.XSLTemplate.6.0","MSXML2.XSLTemplate.3.0"]);function g(F){for(var r in F){try{var E=new ActiveXObject(F[r]);E=null;return F[r]}catch(D){}}}function y(e){if(e){var r=new ActiveXObject(e);if(e===n){r.setProperty("SelectionLanguage","XPath");r.setProperty("SelectionNamespaces","xmlns:daria='http://daria.yandex.ru' xmlns:html='http://www.w3.org/1999/xhtml' xmlns='http://www.w3.org/1999/xhtml'")}return r}}}if(!a&&n){try{document.importNode=function(F,D){var E=F.nodeName;if(E==="#text"){return document.createTextNode(F.data)}else{var e;if(E==="tbody"||E==="tr"){e="table"}else{if(E==="td"){e="tr"}else{if(E==="option"){e="select"}else{e="div"}}}var r=document.createElement(e);r.innerHTML=(D)?F.xml:F.cloneNode(false).xml;return r.firstChild}};a=true}catch(x){}}var j;if(n||s&&b){XML=function(e){this.pid=n;if(e){this.loadXML(e)}};var C=(b)?new DOMParser():null;XML.prototype.loadXML=function(e){if(b){this.document=C.parseFromString(e,"text/xml")}else{this.document=y(this.pid);this.document.loadXML(e)}};function o(e){switch(e){case"daria":return"http://daria.yandex.ru";case"html":return"http://www.w3.org/1999/xhtml";default:return"http://www.w3.org/1999/xhtml"}}var w=(u)?new XPathEvaluator():null;XML.select=function(e,D){var r;if(u){r=w.evaluate(D,e,o,XPathResult.FIRST_ORDERED_NODE_TYPE,null);if(r){r=r.singleNodeValue}}else{if(n){r=e.selectSingleNode(D)}}return r};XML.prototype.select=function(e){return XML.select(this.document.documentElement,e)};XML.export2html=function(e){if(a){return document.importNode(e,true)}};j=true}if(!d&&n&&B&&z){XSLTProcessor=function(){this.template=y(z);this.processor=null};XSLTProcessor.prototype.importStylesheet=function(e){this.template.stylesheet=e;this.processor=this.template.createProcessor()};XSLTProcessor.prototype.transformToDocument=function(r){if(this.processor){var e=y(n);this.processor.input=r;this.processor.output=e;this.processor.transform();return e}};d=true}var t;if(j&&d){XSLT=function(e){this.pid=B;if(e){this.loadXML(e);this.processor=new XSLTProcessor();this.processor.importStylesheet(this.document)}};XSLT.prototype=new XML();XSLT.prototype.transform=function(r){var e=new XML();e.document=this.processor.transformToDocument(r.document);e.nodes=e.document.documentElement;return e};t=true}var p="";try{var k=new Date();var c=new XML('<?xml version="1.0" encoding="utf-8"?><page><messages><message label="3">1</message><message label="2">2</message><message label="1">3</message></messages><labels><label id="1">red</label><label id="2">blue</label><label id="3">green</label></labels></page>');if(c){p+="xml=ok&"}var f=new XSLT('<?xml version="1.0" encoding="utf-8"?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:daria="http://daria.yandex.ru" xmlns="http://www.w3.org/1999/xhtml"><xsl:output method="xml" encoding="utf-8"/><xsl:key name="labels" match="labels/label" use="@id"/><xsl:template match="page"><daria:page><daria:block><xsl:apply-templates select="messages"/></daria:block></daria:page></xsl:template><xsl:template match="messages"><ul><xsl:apply-templates select="message"/></ul></xsl:template><xsl:template match="message"><li><xsl:apply-templates select="key(\'labels\', @label)"/><xsl:apply-templates/></li></xsl:template><xsl:template match="label"><xsl:attribute name="style"><xsl:text>color:</xsl:text><xsl:value-of select="."/></xsl:attribute></xsl:template></xsl:stylesheet>');if(f){p+="xslt=ok&"}if(a){p+="import=ok&"}if(v){p+="adopt=ok&"}var A=f.transform(c);if(A){p+="transform=ok&"}var h=A.select("/daria:page/daria:block");if(h){p+="xpath=ok&"}var l=XML.select(h,"html:ul");if(l){p+="xpath2=ok&"}if(l.nodeName==="ul"){p+="xpathres=ok&"}var q=XML.export2html(l);if(q){p+="export2html=ok&"}var i=new Date();p+="time="+(i.valueOf()-k.valueOf());c=f=A=h=l=q=k=i=null}catch(x){}(new Image()).src="//mailstatic.yandex.net/host-root/1.6/page/index/x.gif?"+p})();